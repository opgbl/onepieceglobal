const grid=document.getElementById("grid");const q=document.getElementById("q");async function fetchEpisodes(){const r=await fetch(API_URL+"/api/episodes");if(!r.ok)throw new Error("API error");const data=await r.json();return data.items||[]}function render(list){grid.innerHTML="";const tpl=document.getElementById("card-tpl");list.forEach(item=>{const node=tpl.content.cloneNode(true);node.querySelector(".title").textContent=`Episodio ${item.id}: ${item.title}`;const qwrap=node.querySelector(".qualities");(item.quality||[]).forEach(q=>{const span=document.createElement("span");span.className="chip";span.textContent=q;qwrap.appendChild(span)});node.querySelector(".btn").href="./video.html?id="+item.id;grid.appendChild(node)})}function filter(list,term){const t=term.trim().toLowerCase();if(!t)return list;return list.filter(e=>(e.title||"").toLowerCase().includes(t)||String(e.id).includes(t))}async function init(){try{const all=await fetchEpisodes();render(all);q.addEventListener("input",()=>render(filter(all,q.value)))}catch(e){grid.innerHTML="<p style=\"padding:1rem\">No se pudo cargar el cat√°logo.</p>"}}init();